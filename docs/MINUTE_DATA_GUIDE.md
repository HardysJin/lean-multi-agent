# åˆ†é’Ÿæ•°æ®ä½¿ç”¨è¯´æ˜

## Yahoo Finance åˆ†é’Ÿæ•°æ®é™åˆ¶

### é‡è¦æç¤º
Yahoo Finance å¯¹åˆ†é’Ÿçº§åˆ«çš„å†å²æ•°æ®æœ‰**æ—¶é—´é™åˆ¶**ï¼š
- é€šå¸¸åªæä¾›**æœ€è¿‘ 7-60 å¤©**çš„åˆ†é’Ÿæ•°æ®
- å…·ä½“å¯ç”¨å¤©æ•°å› è‚¡ç¥¨è€Œå¼‚
- è¶…å‡ºæ­¤èŒƒå›´çš„è¯·æ±‚å°†è¿”å›ç©ºæ•°æ®æˆ–éƒ¨åˆ†æ•°æ®

### æ•°æ®åˆ†è¾¨ç‡å¯¹æ¯”

| åˆ†è¾¨ç‡ | Yahoo Finance å¯ç”¨èŒƒå›´ | é€‚ç”¨åœºæ™¯ |
|--------|----------------------|----------|
| **Minute** (åˆ†é’Ÿ) | æœ€è¿‘ 7-60 å¤© | çŸ­æœŸå›æµ‹ã€æ—¥å†…äº¤æ˜“ç­–ç•¥ |
| **Hour** (å°æ—¶) | æœ€è¿‘ 60-730 å¤© | ä¸­çŸ­æœŸå›æµ‹ |
| **Daily** (æ—¥çº¿) | å¤šå¹´å†å²æ•°æ® | é•¿æœŸå›æµ‹ã€è¶‹åŠ¿ç­–ç•¥ |

## EMAé€šé“ç­–ç•¥æ¨èé…ç½®

### é…ç½® 1ï¼šåˆ†é’Ÿæ•°æ®ï¼ˆçŸ­æœŸå›æµ‹ï¼‰
```python
# Algorithm/EMAChannelStrategy.py
self.set_start_date(2025, 10, 15)   # æœ€è¿‘30å¤©å†…
self.set_end_date(2025, 11, 7)       # ä»Šå¤©
self.symbol = "SOXL"
self.spy = self.add_equity_smart(self.symbol, Resolution.MINUTE)
```

**ä¼˜ç‚¹**ï¼š
- 30åˆ†é’ŸKçº¿ï¼Œé€‚åˆæ—¥å†…äº¤æ˜“ç­–ç•¥
- æ•°æ®ç²¾åº¦é«˜

**ç¼ºç‚¹**ï¼š
- å›æµ‹æ—¶é—´çŸ­
- å¯èƒ½æ— æ³•éªŒè¯é•¿æœŸè¡¨ç°

### é…ç½® 2ï¼šæ—¥çº¿æ•°æ®ï¼ˆé•¿æœŸå›æµ‹ï¼‰
```python
# ä¿®æ”¹ä¸ºæ—¥çº¿å›æµ‹
self.set_start_date(2024, 1, 2)     # å¯ä»¥å›æµ‹å¤šå¹´
self.set_end_date(2025, 11, 7)
self.symbol = "SOXL"
self.spy = self.add_equity_smart(self.symbol, Resolution.DAILY)

# ä¿®æ”¹åˆæˆå™¨ä¸ºæ—¥çº¿
self.consolidator = TradeBarConsolidator(timedelta(days=1))
```

**ä¼˜ç‚¹**ï¼š
- å¯ä»¥å›æµ‹è¾ƒé•¿æ—¶é—´
- éªŒè¯ç­–ç•¥ç¨³å®šæ€§

**ç¼ºç‚¹**ï¼š
- æ— æ³•æ•æ‰æ—¥å†…æ³¢åŠ¨
- ç­–ç•¥é€»è¾‘éœ€è°ƒæ•´

### é…ç½® 3ï¼šå°æ—¶æ•°æ®ï¼ˆæŠ˜ä¸­æ–¹æ¡ˆï¼‰
```python
self.set_start_date(2024, 10, 1)    # æœ€è¿‘1å¹´å†…
self.set_end_date(2025, 11, 7)
self.symbol = "SOXL"
self.spy = self.add_equity_smart(self.symbol, Resolution.HOUR)

# ä¿®æ”¹åˆæˆå™¨ä¸º2å°æ—¶Kçº¿
self.consolidator = TradeBarConsolidator(timedelta(hours=2))
```

## å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆä¸‹è½½å¤±è´¥ï¼Ÿ
```
âŒ SOXL (minute): æ•°æ®ä¸‹è½½å¤±è´¥ï¼Œå›æµ‹å¯èƒ½æ— æ³•æ­£å¸¸è¿è¡Œ
```

**å¯èƒ½åŸå› ï¼š**
1. **Yahoo Finance API é™åˆ¶**ï¼š
   - é”™è¯¯ä¿¡æ¯ï¼š`Only 8 days worth of 1m granularity data are allowed`
   - **å·²è§£å†³**ï¼šç°åœ¨ä¼šè‡ªåŠ¨åˆ†æ‰¹ä¸‹è½½ï¼ˆæ¯æ‰¹7å¤©ï¼‰
2. **æœªæ¥æ—¥æœŸ**ï¼šç¡®ä¿ç»“æŸæ—¥æœŸä¸æ™šäºä»Šå¤©
3. **ç½‘ç»œé—®é¢˜**ï¼šç¡®è®¤èƒ½è®¿é—® Yahoo Finance
4. **è‚¡ç¥¨ä»£ç é”™è¯¯**ï¼šç¡®è®¤ä»£ç æ­£ç¡®ï¼ˆå¦‚ SOXL, SPY, AAPLï¼‰

### Q1.5: åˆ†æ‰¹ä¸‹è½½æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ
```
âš ï¸  Yahoo Finance åˆ†é’Ÿæ•°æ®é™åˆ¶æ¯æ¬¡è¯·æ±‚8å¤©
æ—¶é—´èŒƒå›´: 23 å¤©ï¼Œå°†åˆ† 4 æ‰¹ä¸‹è½½
æ‰¹æ¬¡ 1: 2025-10-15 åˆ° 2025-10-22 âœ“ (1949 æ¡)
æ‰¹æ¬¡ 2: 2025-10-22 åˆ° 2025-10-29 âœ“ (1950 æ¡)
...
åˆå¹¶ 4 ä¸ªæ‰¹æ¬¡çš„æ•°æ®...
âœ… è·å–åˆ° 6629 æ¡çš„æ•°æ®
```

**å·¥ä½œåŸç†ï¼š**
1. æ£€æµ‹æ—¶é—´èŒƒå›´æ˜¯å¦è¶…è¿‡7å¤©
2. è‡ªåŠ¨æ‹†åˆ†æˆå¤šä¸ª7å¤©çš„æ‰¹æ¬¡
3. ä¾æ¬¡ä¸‹è½½æ¯ä¸ªæ‰¹æ¬¡ï¼ˆé—´éš”0.5ç§’é¿å…é¢‘ç‡é™åˆ¶ï¼‰
4. åˆå¹¶æ‰€æœ‰æ‰¹æ¬¡çš„æ•°æ®
5. å»é‡å¹¶æŒ‰æ—¶é—´æ’åº

**ä¼˜åŠ¿ï¼š**
- âœ… ç°åœ¨å¯ä»¥ä¸‹è½½ä»»æ„é•¿åº¦çš„åˆ†é’Ÿæ•°æ®å†å²
- âœ… è‡ªåŠ¨å¤„ç†ï¼Œæ— éœ€æ‰‹åŠ¨å¹²é¢„
- âœ… é€‚åˆå›æµ‹è¾ƒé•¿æ—¶é—´èŒƒå›´ï¼ˆ30å¤©ã€60å¤©ç­‰ï¼‰

### Q2: å¦‚ä½•æŸ¥çœ‹å·²ä¸‹è½½çš„æ•°æ®ï¼Ÿ
```bash
# æŸ¥çœ‹åˆ†é’Ÿæ•°æ®
ls -lh Lean/Data/equity/usa/minute/*.zip

# æŸ¥çœ‹æ—¥çº¿æ•°æ®
ls -lh Lean/Data/equity/usa/daily/*.zip

# æŸ¥çœ‹æ•°æ®å†…å®¹
unzip -p Lean/Data/equity/usa/minute/soxl.zip | head -20
```

### Q3: å¦‚ä½•æ¸…ç†æ—§æ•°æ®é‡æ–°ä¸‹è½½ï¼Ÿ
```bash
# åˆ é™¤ç‰¹å®šè‚¡ç¥¨çš„åˆ†é’Ÿæ•°æ®
rm Lean/Data/equity/usa/minute/soxl.zip

# åˆ é™¤æ‰€æœ‰åˆ†é’Ÿæ•°æ®
rm Lean/Data/equity/usa/minute/*.zip

# é‡æ–°è¿è¡Œå›æµ‹ä¼šè‡ªåŠ¨ä¸‹è½½
./Tests/test_ema_channel.sh
```

## æ‰‹åŠ¨ä¸‹è½½æ•°æ®

å¦‚æœè‡ªåŠ¨ä¸‹è½½å¤±è´¥ï¼Œå¯ä»¥æ‰‹åŠ¨ä¸‹è½½ï¼š

```python
# test_download.py
from Utils.download_data import download_and_convert
from datetime import datetime, timedelta

# ä¸‹è½½æœ€è¿‘30å¤©çš„åˆ†é’Ÿæ•°æ®
end = datetime.now()
start = end - timedelta(days=30)

download_and_convert(
    'SOXL',
    start.strftime('%Y-%m-%d'),
    end.strftime('%Y-%m-%d'),
    resolution='minute'
)
```

è¿è¡Œï¼š
```bash
python3 test_download.py
```

## å»ºè®®

1. **å¼€å‘é˜¶æ®µ**ï¼šä½¿ç”¨åˆ†é’Ÿæ•°æ®è¿›è¡Œå¿«é€Ÿæµ‹è¯•ï¼ˆ7-30å¤©ï¼‰
2. **éªŒè¯é˜¶æ®µ**ï¼šåˆ‡æ¢åˆ°æ—¥çº¿æ•°æ®è¿›è¡Œé•¿æœŸå›æµ‹ï¼ˆ1-5å¹´ï¼‰
3. **ç”Ÿäº§ç¯å¢ƒ**ï¼šæ ¹æ®ç­–ç•¥ç‰¹ç‚¹é€‰æ‹©åˆé€‚çš„åˆ†è¾¨ç‡

## æ•°æ®æ ¼å¼è¯´æ˜

### LEAN å®˜æ–¹æ ¼å¼

æˆ‘ä»¬çš„ä¸‹è½½å·¥å…·ç°åœ¨å®Œå…¨éµå¾ª LEAN å®˜æ–¹æ•°æ®æ ¼å¼ï¼š

#### åˆ†é’Ÿæ•°æ®æ ¼å¼
```
ç›®å½•ç»“æ„ï¼š
Lean/Data/equity/usa/minute/
  â”œâ”€â”€ soxl/
  â”‚   â”œâ”€â”€ 20251031_trade.zip
  â”‚   â”‚   â””â”€â”€ 20251031_soxl_minute_trade.csv
  â”‚   â”œâ”€â”€ 20251101_trade.zip
  â”‚   â””â”€â”€ ...
  â””â”€â”€ spy/
      â”œâ”€â”€ 20240102_trade.zip
      â””â”€â”€ ...

æ•°æ®æ ¼å¼ï¼ˆCSV å†…å®¹ï¼‰ï¼š
20251031 09:30,487700,487999,483100,483800,4876707
20251031 09:31,483899,486800,483499,486800,587913
```

**ç‰¹ç‚¹ï¼š**
- æ¯ä¸ªè‚¡ç¥¨ä¸€ä¸ªæ–‡ä»¶å¤¹
- æ¯å¤©ä¸€ä¸ª `YYYYMMDD_trade.zip` æ–‡ä»¶
- CSV æ–‡ä»¶åï¼š`YYYYMMDD_symbol_minute_trade.csv`
- ä»·æ ¼æ ¼å¼ï¼š**æ•´æ•°**ï¼ˆä»·æ ¼ Ã— 10000ï¼‰
- æ—¶é—´æ ¼å¼ï¼š`YYYYMMDD HH:MM`

#### æ—¥çº¿æ•°æ®æ ¼å¼
```
ç›®å½•ç»“æ„ï¼š
Lean/Data/equity/usa/daily/
  â”œâ”€â”€ soxl.zip
  â”‚   â””â”€â”€ soxl.csv
  â””â”€â”€ spy.zip
      â””â”€â”€ spy.csv

æ•°æ®æ ¼å¼ï¼ˆCSV å†…å®¹ï¼‰ï¼š
20240102 00:00,487700,487999,483100,483800,4876707
20240103 00:00,483899,486800,483499,486800,5879130
```

**ç‰¹ç‚¹ï¼š**
- æ¯ä¸ªè‚¡ç¥¨ä¸€ä¸ª `symbol.zip` æ–‡ä»¶
- æ‰€æœ‰æ—¥çº¿æ•°æ®åœ¨ä¸€ä¸ª CSV æ–‡ä»¶ä¸­
- ä»·æ ¼æ ¼å¼ï¼š**æ•´æ•°**ï¼ˆä»·æ ¼ Ã— 10000ï¼‰
- æ—¶é—´æ ¼å¼ï¼š`YYYYMMDD 00:00`

### ä»·æ ¼æ ¼å¼å¯¹æ¯”

| åˆ†è¾¨ç‡ | ä»·æ ¼æ ¼å¼ | ç¤ºä¾‹ | è¯´æ˜ |
|--------|---------|------|------|
| Minute | æµ®ç‚¹æ•° | 48.77 | LEAN å®˜æ–¹åˆ†é’Ÿæ ¼å¼ |
| Hour | æ•´æ•°Ã—10000 | 487700 | ä¼ ç»Ÿæ ¼å¼ |
| Daily | æ•´æ•°Ã—10000 | 487700 | ä¼ ç»Ÿæ ¼å¼ |

## æ•°æ®æºå¯¹æ¯”

### Yahoo Finance (å½“å‰ä½¿ç”¨)
- âœ… **å…è´¹**
- âœ… **å·²å®ç°åˆ†æ‰¹ä¸‹è½½**ï¼šç»•è¿‡8å¤©é™åˆ¶
- âœ… ç°åœ¨æ”¯æŒä»»æ„é•¿åº¦çš„å†å²åˆ†é’Ÿæ•°æ®
- âš ï¸ æ¯æ‰¹é—´éš”0.5ç§’ï¼Œé•¿æ—¶é—´èŒƒå›´ä¸‹è½½è¾ƒæ…¢
- âš ï¸ å¯èƒ½è¢«é™åˆ¶é¢‘ç‡ï¼ˆéœ€è¦ç­‰å¾…ï¼‰

### Finnhub (å·²æµ‹è¯•)
- âœ… å…è´¹ç‰ˆæ”¯æŒå®æ—¶æŠ¥ä»·
- âŒ **å†å²Kçº¿éœ€è¦ä»˜è´¹**ï¼ˆåŒ…æ‹¬åˆ†é’Ÿæ•°æ®ï¼‰
- ğŸ’° ä»˜è´¹è®¢é˜…èµ·ä»·çº¦ $59/æœˆ

### å…¶ä»–æ•°æ®æº

å¦‚éœ€æ›´é«˜è´¨é‡æˆ–æ›´é•¿å†å²çš„åˆ†é’Ÿæ•°æ®ï¼š
- **Alpha Vantage**ï¼šå…è´¹æœ‰é™åˆ¶ï¼ˆæ¯å¤©500æ¬¡ï¼‰ï¼Œéœ€è¦ API Key
- **IEX Cloud**ï¼šä»˜è´¹ï¼Œæ•°æ®è´¨é‡é«˜ï¼Œèµ·ä»· $9/æœˆ
- **Polygon.io**ï¼šä»˜è´¹ï¼Œä¸“ä¸šçº§æ•°æ®ï¼Œèµ·ä»· $29/æœˆ
- **Tiingo**ï¼šä»˜è´¹ï¼ŒåŒ…å«åŸºæœ¬é¢æ•°æ®
- **è‡ªå»ºæ•°æ®åº“**ï¼šå®æ—¶é‡‡é›†å¹¶å­˜å‚¨

## ç›¸å…³æ–‡ä»¶

- `Algorithm/EMAChannelStrategy.py` - EMAé€šé“ç­–ç•¥ä¸»æ–‡ä»¶
- `Algorithm/SmartAlgorithm.py` - æ™ºèƒ½æ•°æ®ä¸‹è½½åŸºç±»
- `Utils/download_data.py` - æ•°æ®ä¸‹è½½å·¥å…·
- `Configs/config_ema_channel.json` - ç­–ç•¥é…ç½®
- `Tests/test_ema_channel.sh` - æµ‹è¯•è„šæœ¬
